# üß™ –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã Knowledge Base API

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã –¥–ª—è API Knowledge Base —Å–∏—Å—Ç–µ–º—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º pytest –∏ Flask-testing.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ç–µ—Å—Ç–æ–≤)
- [–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤](#–∑–∞–ø—É—Å–∫-—Ç–µ—Å—Ç–æ–≤)
- [–û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Ç–µ—Å—Ç–æ–≤)
- [–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞](#–ø–æ–∫—Ä—ã—Ç–∏–µ-–∫–æ–¥–∞)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
.\.venv\Scripts\Activate.ps1

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
pip install pytest pytest-flask requests pytest-cov

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—è —Å–∫—Ä–∏–ø—Ç
python run_tests.py --install
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```
tests/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ conftest.py                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –∏ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ test_auth.py               # –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ test_data.py               # –¢–µ—Å—Ç—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ test_posts.py              # –¢–µ—Å—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞–º–∏
‚îî‚îÄ‚îÄ test_integration.py        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
```

## üèÉ‚Äç‚ôÇÔ∏è –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã
```bash
pytest
# –∏–ª–∏
python run_tests.py
```

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Ç–µ—Å—Ç–æ–≤
```bash
# –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
pytest tests/test_auth.py -v
python run_tests.py --auth

# –¢–µ—Å—Ç—ã –¥–∞–Ω–Ω—ã—Ö
pytest tests/test_data.py -v
python run_tests.py --data

# –¢–µ—Å—Ç—ã –ø–æ—Å—Ç–æ–≤
pytest tests/test_posts.py -v
python run_tests.py --posts

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/test_integration.py -v
python run_tests.py --integration
```

### –° –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
```bash
pytest -v -s
python run_tests.py --verbose
```

### –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
```bash
pytest --cov=app --cov-report=html --cov-report=term
python run_tests.py --coverage
```

## üìä –û–ø–∏—Å–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

### üîê –¢–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`test_auth.py`)

**TestAuthentication**
- `test_admin_login_success` - –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `test_admin_login_wrong_password` - –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å
- `test_admin_login_nonexistent_user` - –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `test_admin_login_missing_credentials` - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
- `test_editor_login_success` - –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- `test_get_profile_with_valid_token` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å —Ç–æ–∫–µ–Ω–æ–º
- `test_get_profile_without_token` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –±–µ–∑ —Ç–æ–∫–µ–Ω–∞
- `test_get_profile_with_invalid_token` - –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ç–æ–∫–µ–Ω

**TestStudentFlow**
- `test_student_cities_access` - –î–æ—Å—Ç—É–ø –∫ –≥–æ—Ä–æ–¥–∞–º –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `test_student_groups_access` - –î–æ—Å—Ç—É–ø –∫ –≥—Ä—É–ø–ø–∞–º
- `test_student_specialities_access` - –î–æ—Å—Ç—É–ø –∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º
- `test_student_education_forms_access` - –î–æ—Å—Ç—É–ø –∫ —Ñ–æ—Ä–º–∞–º –æ–±—É—á–µ–Ω–∏—è

### üìä –¢–µ—Å—Ç—ã –¥–∞–Ω–Ω—ã—Ö (`test_data.py`)

**TestDataRetrieval**
- `test_articles_endpoint` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç–∞—Ç–µ–π
- `test_articles_with_pagination` - –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å—Ç–∞—Ç–µ–π
- `test_categories_endpoint` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `test_cities_endpoint` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–æ–≤
- `test_groups_endpoint` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≥—Ä—É–ø–ø
- `test_specialities_endpoint` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π
- `test_specialities_with_filter` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π
- `test_education_forms_endpoint` - –§–æ—Ä–º—ã –æ–±—É—á–µ–Ω–∏—è
- `test_admission_years_endpoint` - –ì–æ–¥—ã –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è
- `test_institution_types_endpoint` - –¢–∏–ø—ã —É—á—Ä–µ–∂–¥–µ–Ω–∏–π

**TestHealthCheck**
- `test_health_check_endpoint` - Health check API
- `test_invalid_endpoint` - –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π endpoint

### üìù –¢–µ—Å—Ç—ã –ø–æ—Å—Ç–æ–≤ (`test_posts.py`)

**TestPostCreation**
- `test_create_article_as_admin` - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
- `test_create_article_as_editor` - –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º
- `test_create_article_without_auth` - –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- `test_create_article_missing_title` - –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞
- `test_create_article_missing_content` - –°–æ–∑–¥–∞–Ω–∏–µ –±–µ–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ

**TestPostPublishing**
- `test_publish_article_as_admin` - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
- `test_unpublish_article_as_admin` - –°–Ω—è—Ç–∏–µ —Å –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- `test_publish_nonexistent_article` - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç–∞—Ç—å–∏
- `test_publish_article_without_auth` - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

**TestPostManagement**
- `test_get_article_by_id` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –ø–æ ID
- `test_update_article_as_admin` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏
- `test_delete_article_as_admin` - –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏
- `test_filter_articles_by_published_status` - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É

### üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`test_integration.py`)

**TestIntegrationFlows**
- `test_complete_admin_workflow` - –ü–æ–ª–Ω—ã–π workflow –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `test_student_data_access_workflow` - Workflow –¥–æ—Å—Ç—É–ø–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∫ –¥–∞–Ω–Ω—ã–º
- `test_editor_workflow` - Workflow —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
- `test_unauthorized_access_restrictions` - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
- `test_data_consistency` - –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

## üéØ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ

–¢–µ—Å—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é in-memory SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:

- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**:
  - –ê–¥–º–∏–Ω: `admin@test.com` / `Admin123!`
  - –†–µ–¥–∞–∫—Ç–æ—Ä: `editor@test.com` / `Editor123!`

- **–ì–æ—Ä–æ–¥–∞**: –ú–æ—Å–∫–≤–∞, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –ö–∞–∑–∞–Ω—å
- **–°–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏**: –ò–¢, –≠–∫–æ–Ω–æ–º–∏–∫–∞
- **–§–æ—Ä–º—ã –æ–±—É—á–µ–Ω–∏—è**: –û—á–Ω–∞—è, –ó–∞–æ—á–Ω–∞—è
- **–ì–æ–¥—ã –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è**: 2023, 2024

## üìà –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º (`--coverage`), –æ—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤:
- –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
- HTML –æ—Ç—á–µ—Ç: `htmlcov/index.html`

## üêõ –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
pytest -v -s --tb=short
python run_tests.py --verbose
```

–§–ª–∞–≥–∏:
- `-v` - –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
- `-s` - –ø–æ–∫–∞–∑–∞—Ç—å print() –≤ —Ç–µ—Å—Ç–∞—Ö
- `--tb=short` - –∫–æ—Ä–æ—Ç–∫–∏–µ traceback

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `conftest.py`:
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –§–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è —Ç–æ–∫–µ–Ω–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ñ–∞–π–ª `test_*.py` –≤ –ø–∞–ø–∫–µ `tests/`
2. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏–∑ `conftest.py`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Ä–∫–µ—Ä—ã pytest –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:
   - `@pytest.mark.auth` - –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - `@pytest.mark.data` - –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö
   - `@pytest.mark.posts` - –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –ø–æ—Å—Ç–æ–≤
   - `@pytest.mark.integration` - –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

–ü—Ä–∏–º–µ—Ä:
```python
import pytest

class TestNewFeature:
    @pytest.mark.data
    def test_new_endpoint(self, client):
        response = client.get('/api/new-endpoint')
        assert response.status_code == 200
```

## üö¶ CI/CD

–¢–µ—Å—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ CI/CD –ø–∞–π–ø–ª–∞–π–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
```bash
python run_tests.py --coverage
```

–ò–ª–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
pytest --tb=short
```
